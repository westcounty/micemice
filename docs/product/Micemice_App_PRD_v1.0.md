# Micemice App 产品需求文档（PRD）V1.0

- 文档版本：V1.0
- 文档日期：2026-02-07
- 产品形态：Android App（手机+平板），单端覆盖业务与管理能力
- 项目目录：`D:\work\micemice`

## 1. 产品愿景与定位

Micemice 是面向生物实验室小鼠管理的全生命周期 App，核心价值是让博士生在动物房现场完成高频动作，确保数据可追溯、流程可审计、决策可量化。

### 1.1 北极星指标

1. 关键节点漏操作率（配种、断奶、转笼、淘汰）下降 >= 60%。
2. 实验筛鼠平均耗时下降 >= 50%。
3. 合规检查资料准备耗时下降 >= 70%。

### 1.2 产品原则

1. 移动优先：扫码即达、3步闭环。
2. 合规内建：所有关键操作默认留痕。
3. 低认知负担：按任务驱动，不按数据库思维驱动。
4. 可配置：不同实验室流程可模板化。

## 2. 用户与场景

### 2.1 角色定义

1. 博士生/实验员：执行繁育、记录、筛鼠、实验。
2. PI：查看课题产出、资源消耗、风险。
3. 课题组管理员：维护字典、权限、导入导出。
4. 动物中心人员：接收并执行服务任务。
5. 兽医/IACUC秘书：审计与检查。

### 2.2 核心使用场景

1. 动物房现场：扫码笼卡，完成转笼或断奶。
2. 每日巡检：工作台查看今日待办和逾期风险。
3. 实验准备：按基因型、年龄、性别筛选 cohort。
4. 合规检查：一键导出协议、操作记录、异常处理记录。

## 3. 产品范围

### 3.1 本期范围（全在 App）

1. 登录与权限
2. 主数据管理（品系/等位基因/房间机架笼位）
3. 笼位与个体管理
4. 繁育流程管理
5. 分型管理
6. 实验 cohort 管理
7. 任务与提醒
8. 合规与审计
9. 报表与导出
10. 系统配置与数据导入导出

### 3.2 非本期范围

1. 独立 Web 后台
2. 复杂计费结算引擎
3. 第三方硬件深度集成（先保留接口）

## 4. 信息架构

底部一级导航：

1. 工作台
2. 笼位
3. 个体
4. 繁育
5. 分型
6. 实验
7. 任务
8. 报表
9. 管理

## 5. 功能需求（模块级）

## 5.1 登录与权限

### 目标

保障多角色在同一 App 安全协同。

### 功能

1. 账号登录（支持组织切换）
2. 角色权限（RBAC）
3. 会话安全与设备管理
4. 审计日志（关键动作全量记录）

### 规则

1. 所有写操作记录操作者、时间、变更前后值。
2. 关键配置变更需要二次确认。

### 验收

1. 任意对象变更可回溯到具体用户和时间点。

## 5.2 主数据管理

### 功能

1. 品系与等位基因字典
2. 基因型模板
3. 房间/机架/笼位结构
4. 项目与协议基础信息

### 规则

1. 品系命名与基因型录入按模板校验。
2. 禁止使用自由文本破坏主数据一致性。

## 5.3 笼位管理

### 功能

1. 新建笼、转笼、并笼、拆笼
2. 笼卡详情与历史
3. 扫码进入笼卡
4. 笼容量和拥挤预警

### 规则

1. 超容量时强提醒，可配置是否阻断。
2. 笼位变更必须写入时间线。

### 验收

1. 扫码到笼卡详情 < 2 秒。

## 5.4 个体管理

### 功能

1. 个体档案（耳号/RFID/条码）
2. 状态管理（在笼/实验中/淘汰/死亡）
3. 体重、健康与处理事件
4. 附件（图片/报告）

### 规则

1. 状态变化符合状态机，不允许非法跳转。
2. 关键状态变更需确认并可审计。

## 5.5 繁育管理

### 功能

1. 配种计划与执行
2. 查栓、产仔、断奶、留种、退役
3. 繁育日历和自动提醒
4. 家系追踪

### 规则

1. 时间窗驱动提醒（如断奶窗口）。
2. 近交风险提示。

## 5.6 分型管理

### 功能

1. 采样登记
2. 批次管理（板位/送检）
3. 结果回填（手工/文件）
4. 复检与版本化

### 规则

1. 分型结果不覆盖历史，按版本记录。
2. 冲突结果需人工确认。

## 5.7 实验管理

### 功能

1. cohort 条件筛选
2. 入组锁定与盲法编码
3. 实验事件时间线
4. 退出与归档

### 规则

1. cohort 条件快照化，防止后续漂移。

## 5.8 任务与提醒

### 功能

1. 今日待办
2. 逾期任务
3. 模板任务
4. 通知中心（App 内 + 推送）

### 规则

1. 优先级：合规风险 > 动物福利 > 实验节点。

## 5.9 合规与审计

### 功能

1. 协议绑定
2. 到期提醒
3. 培训资质校验
4. 合规导出包（CSV/PDF）

### 规则

1. 无协议或协议过期时关键动作阻断或强警告。
2. 审计日志不可物理删除。

## 5.10 报表与导出

### 功能

1. 笼位占用率
2. 繁殖效率
3. 存活率
4. 任务完成率
5. 成本估算（V1基础版）

### 规则

1. 报表口径统一，按组织配置。

## 5.11 管理中心

### 功能

1. 字典维护
2. 角色权限管理
3. 导入导出
4. 通知策略
5. 审计查看

## 6. 页面级设计（关键页面）

## 6.1 工作台

### 目标

让用户 30 秒内知道今天必须做什么。

### 区块

1. 今日关键任务
2. 风险预警（协议到期/逾期/超笼）
3. 最近操作
4. 快捷动作（配笼/断奶/采样/转笼）

## 6.2 笼卡详情页

### 信息

1. 笼位信息
2. 当前个体列表
3. 繁育状态
4. 最近事件

### 操作

1. 转笼
2. 并笼
3. 拆笼
4. 批量更新个体状态

## 6.3 个体详情页

### 信息

1. 基础信息
2. 分型记录
3. 家系关系
4. 实验记录

### 操作

1. 更新状态
2. 添加事件
3. 查看上下游谱系

## 6.4 配种向导

1. 选择亲本
2. 校验规则
3. 提交并生成后续任务

## 6.5 断奶向导

1. 批量选择幼鼠
2. 自动推荐分笼
3. 一键确认并生成笼位变更

## 6.6 分型页

1. 采样录入
2. 批次与板位
3. 回填与冲突处理

## 6.7 Cohort 构建页

1. 条件筛选
2. 可用数量预览
3. 锁定队列与导出

## 6.8 管理中心

1. 权限配置
2. 主数据维护
3. 导入导出
4. 审计查询

## 7. 字段规范（核心对象）

## 7.1 Cage

1. cage_id
2. room_id
3. rack_id
4. cage_type
5. capacity_limit
6. current_count
7. status
8. tags
9. created_at
10. updated_at

## 7.2 Animal

1. animal_id
2. identifier（ear tag / RFID / barcode）
3. sex
4. date_of_birth
5. strain_id
6. genotype
7. father_id
8. mother_id
9. status
10. current_cage_id
11. protocol_id
12. created_at
13. updated_at

## 7.3 Mating

1. mating_id
2. male_id
3. female_id
4. start_date
5. plug_check_date
6. expected_birth_date
7. result
8. notes

## 7.4 GenotypingResult

1. result_id
2. sample_id
3. batch_id
4. gene_marker
5. call_value
6. version
7. reviewer
8. reviewed_at

## 7.5 Task

1. task_id
2. task_type
3. target_type
4. target_id
5. due_time
6. priority
7. assignee_id
8. status

## 8. 交互与体验规范

1. 高频流程 3 步内闭环。
2. 默认批量操作优先，减少重复点击。
3. 危险动作红色视觉强化+二次确认。
4. 表单采用渐进披露，只显示当前必要字段。
5. 支持离线草稿，恢复网络后自动同步。

## 9. 架构与技术要求（Android）

1. 架构：MVVM + Clean Architecture
2. UI：Jetpack Compose
3. 本地存储：Room
4. 同步：WorkManager + 后台重试
5. 网络：Retrofit + Kotlinx Serialization
6. 依赖注入：Hilt
7. 日志与追踪：结构化日志 + 崩溃监控

## 10. 非功能需求

1. 性能：列表首屏 < 1.5 秒；扫码跳转 < 2 秒。
2. 稳定性：崩溃率 < 0.5%。
3. 安全：传输加密，敏感字段加密存储。
4. 可恢复：断网可用，冲突可处理。
5. 可审计：审计日志不可篡改。

## 11. 数据治理与合规

1. 符合 IACUC/OLAW 记录思路：关键操作必须留痕。
2. 支持 3Rs 指标化追踪（减少不必要繁育/优化使用）。
3. 输出 ARRIVE 研究记录辅助字段。
4. 关键记录默认长期保存，支持归档策略。

## 12. 发布计划（V1）

1. Sprint 1：账号权限、主数据、笼位/个体基础。
2. Sprint 2：繁育主流程与任务提醒。
3. Sprint 3：分型与 cohort。
4. Sprint 4：报表、审计、导入导出、性能收敛。

## 13. 风险与应对

1. 需求膨胀：坚持 V1 范围清单，延后高级结算。
2. 数据质量：字段校验 + 导入前校验 + 审计纠错。
3. 离线冲突：事件日志 + 冲突中心。
4. 用户上手：新手引导与模板化流程。

## 14. 验收标准

1. 繁育核心流程（配种-断奶-分笼）端到端可用。
2. 审计日志覆盖全部关键写操作。
3. 报表与导出可支撑内部周会与检查。
4. 关键KPI达到第1章目标阈值。

## 15. 参考依据

1. SoftMouse: https://www.softmouse.net/
2. PyRAT: https://www.scionics.com/pyrat
3. Labguru Rodents: https://help.labguru.com/en/articles/1492340-managing-your-rodent-colonies-in-labguru
4. TOPAZ Animal Census: https://topazti.com/animal-census/
5. Transnetyx Colony App: https://apps.apple.com/us/app/transnetyx-colony/id1241001338
6. OLAW PHS Policy: https://olaw.nih.gov/policies-laws/phs-policy.htm
7. Guide for the Care and Use of Laboratory Animals: https://olaw.nih.gov/policies-laws/guide-care-use-lab-animals
8. ARRIVE 2.0: https://arriveguidelines.org/arrive-guidelines
9. NC3Rs: https://nc3rs.org.uk/who-we-are/3rs
10. MGI Nomenclature: https://www.informatics.jax.org/mgihome/nomen/strains.shtml
